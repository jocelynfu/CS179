<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script src="../libs/bootstrap/js/bootstrap.min.js" charset="utf-8"></script>
    <link rel="stylesheet" type="text/css" href="../libs/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/myStyle.css">
</head>
    <body>
         <!-- Start of cook page -->
        <div data-role="page" id="cook">

            <div data-role="header">
                <h1>Cart</h1>
            </div><!-- /header -->

            <div role="main" class="ui-content">
                <div id="itemsList"></div>
            </div><!-- /content -->

            <div data-role="footer">
                <div data-role="navbar">
                <ul>
                    <li><a rel="external" href="#" data-rel="back">Back</a></li>
                    <li><a rel="external" href="../">Home</a></li>
                    <li><a rel="external" href="../pages/cart.html"> Cart </a></p>
                </ul>
                </div>
            </div><!-- /footer -->
            <script language="javascript">
                function getCart() {
                    var cart = [];
                    if (localStorage.cart) {
                        cart = JSON.parse(localStorage.getItem("cart"));
                    }
                    return cart;
                }

                function printCart() {
                    cart = getCart();
                    var ul = document.createElement('ul');
                    ul.setAttribute('id','items');
                    document.getElementById('itemsList').innerHTML = "";
                    document.getElementById('itemsList').appendChild(ul);
                    cart.forEach(renderList);

                    function renderList(item, index) {
                        var li = document.createElement("LI");
                        li.setAttribute('class','item');
                        li.setAttribute('id', index);
                        ul.appendChild(li);
                        t = document.createTextNode(index);
                        if (!item.mealKit) {
                            li.innerHTML=li.innerHTML + "<img src='" + item.img + "' width='30'> " + item.name + " Volume: " + item.volume + "  Number: " + item.number + "<button type='button' onclick='deleteItem(this.parentElement)'>Remove</button>";
                        } else {
                            li.innerHTML=li.innerHTML + "<img src='" + item.img + "' width='30'> " + item.name + " Servings: " + item.number + "<button type='button' onclick='deleteItem(this.parentElement)'>Remove</button>";
                        }     
                    }
                }

                function deleteItem(item) {
                    cart = getCart();
                    cart.splice(item.id, 1);
                    localStorage.setItem("cart", JSON.stringify(cart));
                    printCart();    
                }

                window.onload=function() { 
                    console.log("here");
                    printCart();
                }
            </script>
        </div><!-- /page -->
    </body>
</html>
